<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planning Area Restrictions with AR</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://rawcdn.githack.com/AR-js-org/AR.js/3.3.2/aframe/build/aframe-ar.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        #map {
            height: 60vh; /* Adjust height for AR view */
            width: 100%;
        }
        #ar-scene {
            height: 40vh;
            width: 100%;
            position: absolute;
            top: 60vh;
            z-index: 1000;
        }
    </style>
</head>
<body>

<div id="map"></div>
<a-scene embedded arjs="sourceType: webcam;" id="ar-scene">
    <!-- Example AR marker for an Article 4 Direction -->
    <a-box position="0 0 0" material="color: red;" gps-entity-place="latitude: 51.505; longitude: -0.09">
        <a-text value="Article 4 Area" position="0 1 0"></a-text>
    </a-box>
</a-scene>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/@turf/turf/turf.min.js"></script>

<script>
    const mainMap = L.map('map').setView([51.505, -0.09], 10);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: 'Â© OpenStreetMap'
    }).addTo(mainMap);

    // Load GeoJSON for restricted areas (as in your original code)
    fetch('https://raw.githubusercontent.com/Jody0202/Geojson-Data/main/article-4-direction-area.geojson')
        .then(response => response.json())
        .then(data => {
            L.geoJSON(data, {
                style: function () {
                    return { color: 'blue', weight: 2, fillOpacity: 0.5 };
                }
            }).addTo(mainMap);

            // Add AR markers for each restricted area in the GeoJSON
            data.features.forEach(feature => {
                const [lon, lat] = feature.geometry.coordinates[0][0]; // Get coordinates of the polygon
                createARMarker(lat, lon, feature.properties);
            });
        })
        .catch(error => console.error('Error loading GeoJSON:', error));

    function createARMarker(lat, lon, properties) {
        // Create a new AR entity for each restricted area
        const scene = document.querySelector('a-scene');
        const box = document.createElement('a-box');
        box.setAttribute('gps-entity-place', `latitude: ${lat}; longitude: ${lon}`);
        box.setAttribute('material', 'color: red; opacity: 0.7');
        box.setAttribute('scale', '1 1 1');

        // Add a label for the restriction
        const text = document.createElement('a-text');
        text.setAttribute('value', properties['notes'] || 'Restricted Area');
        text.setAttribute('position', '0 1.5 0');
        text.setAttribute('scale', '2 2 2');

        // Append to the box
        box.appendChild(text);
        scene.appendChild(box);
    }
</script>

</body>
</html>
